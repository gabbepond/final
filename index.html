<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Movie Buff</title>
    <script defer src="main.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 min-h-screen flex flex-col items-center p-6">
    <h1 class="text-3xl font-bold mb-6">Movie Buff</h1>
    <form id="searchForm" class="w-full max-w-md mb-6">
      <div class="flex items-center border-b border-gray-500 py-2">
        <select
          id="filterSelect"
          class="mr-2 bg-transparent border-none text-gray-700 py-1 px-2 focus:outline-none"
        >
          <option value="">All Genres</option>
          <option value="Action">Action</option>
          <option value="Comedy">Comedy</option>
          <option value="Drama">Drama</option>
          <option value="Horror">Horror</option>
          <option value="Romance">Romance</option>
          <option value="Thriller">Thriller</option>
          <option value="Sci-Fi">Sci-Fi</option>
        </select>
        <input
          id="searchInput"
          type="text"
          placeholder="Search for a movie..."
          class="appearance-none bg-transparent border-none w-full text-gray-700 mr-3 py-1 px-2 leading-tight focus:outline-none"
        />
        <button
          type="submit"
          class="flex-shrink-0 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
        >
          Search
        </button>
      </div>
    </form>
    <div id="results" class="w-full max-w-4xl space-y-4"></div>

    <!-- Popup Modal -->
    <div
      id="moviePopup"
      class="fixed inset-0 bg-black bg-opacity-75 flex justify-center items-center hidden"
    >
      <div class="relative bg-white rounded shadow-lg p-4 max-w-lg">
        <button
          id="closePopup"
          class="absolute top-2 right-2 text-red-500 hover:text-red-700 font-bold"
        >
          &times;
        </button>
        <img
          id="popupPoster"
          src=""
          alt="Movie Poster"
          class="w-full rounded mb-4"
        />
        <p id="popupDescription" class="text-gray-700"></p>
      </div>
    </div>
  </body>
    <!-- Movie Icon on the Left -->
    <div class="absolute top-4 left-4 cursor-pointer">
      <img src="/movie-icon.png" alt="Movie Icon" id="movieIcon" class="w-16 h-16"/>
    </div>
  
    <!-- Profile Icon on the Right -->
    <div class="absolute top-4 right-4 cursor-pointer">
      <img src="/user-profile-icon-free-vector.jpg" alt="Profile Icon" id="profileIcon" class="w-16 h-16 rounded-full border border-gray-300"/>
    </div>
  
  <!-- script -->
  <script>
    const API_KEY = "8fca2581";

    const fetchMovies = async (title, genre) => {
      try {
        //const url = `https://www.omdbapi.com/?apikey=${API_KEY}&s=${title || "a"}`;
        const url = `https://www.omdbapi.com/?apikey=${API_KEY}&s=${
          title || "a"
        }&type=movie`;
        const response = await fetch(url);
        const data = await response.json();
console.log(data);
        if (data.Search) {
          let filteredMovies = data.Search.filter(movie => movie.Poster && movie.Poster !== "N/A");
          displayMovies(filteredMovies);
        } else {
          displayError(data.Error || "No results found.");
        }
      } catch (error) {
        displayError("Error fetching data: " + error.message);
      }
    };

const displayMovies = (movies) => {
  const resultsContainer = document.getElementById("results");
  resultsContainer.innerHTML = "";
  resultsContainer.className = "grid grid-cols-2 gap-4";

  movies.forEach((movie) => {
    const movieDiv = document.createElement("div");
    movieDiv.className =
      "p-4 border border-gray-300 rounded shadow-md flex flex-col items-center cursor-pointer";
    movieDiv.innerHTML = `
      <img src="${movie.Poster}" alt="${movie.Title}" class="w-32 h-48 object-cover mb-4"/>
      <div class="text-center">
        <h3 class="text-lg font-bold">${movie.Title}</h3>
        <p class="text-gray-600">Year: ${movie.Year}</p>
        <p class="text-gray-600">Rating: ${movie.imdbRating || "N/A"}</p>
        <p class="text-gray-600">Genre: ${movie.Genre || "N/A"}</p>
      </div>
    `;

    // Add click event to show popup with description
    movieDiv.addEventListener("click", () =>
      showPopup(movie.Poster, movie.imdbID)
    );

    resultsContainer.appendChild(movieDiv);
  });
};


    const displayError = (message) => {
      const resultsContainer = document.getElementById("results");
      resultsContainer.innerHTML = `<p class='text-red-500'>${message}</p>`;
    };

    const showPopup = async (posterUrl, imdbID) => {
      const popup = document.getElementById("moviePopup");
      const popupPoster = document.getElementById("popupPoster");
      const popupDescription = document.getElementById("popupDescription");

      popupPoster.src = posterUrl;

      // Fetch movie details to get the description
      try {
        const response = await fetch(
          `https://www.omdbapi.com/?apikey=${API_KEY}&i=${imdbID}`
        );
        const movieDetails = await response.json();
        popupDescription.textContent =
          movieDetails.Plot || "No description available.";
      } catch (error) {
        popupDescription.textContent = "Error fetching description.";
      }

      popup.classList.remove("hidden");
    };

    const closePopup = () => {
      const popup = document.getElementById("moviePopup");
      popup.classList.add("hidden");
    };

    document.addEventListener("DOMContentLoaded", () => {
      const searchForm = document.getElementById("searchForm");
      const filterSelect = document.getElementById("filterSelect");

      // Display all movies when the app loads
      fetchMovies("", filterSelect.value);

      // Search functionality
      searchForm.addEventListener("submit", (event) => {
        event.preventDefault();
        const searchInput = document.getElementById("searchInput");
        const selectedGenre = filterSelect.value;

        fetchMovies(searchInput.value, selectedGenre);
      });

      // Close popup event
      document
        .getElementById("closePopup")
        .addEventListener("click", closePopup);

      // Filter by genre when the genre dropdown changes
      filterSelect.addEventListener("change", (event) => {
        const selectedGenre = event.target.value;
        const searchInput = document.getElementById("searchInput");

        fetchMovies(searchInput.value, selectedGenre);
      });
    });
  </script>
</html>




 